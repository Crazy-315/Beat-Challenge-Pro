<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤ æ™ºèƒ½å£è¯­æŒ‘æˆ˜ Â· çœ‹å›¾è¯»éŸ³ Â· ç§¯åˆ†ç‰ˆ</title>
    <!-- Font Awesome 6 å›¾æ ‡åº“ (ç”¨äºä¸°å¯Œå›¾ç‰‡è¡¨ç°) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(145deg, #0b1c26 0%, #1a2f3a 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', 'Poppins', Roboto, sans-serif;
            padding: 16px;
        }

        .game-card {
            max-width: 950px;
            width: 100%;
            background: rgba(12, 27, 35, 0.95);
            backdrop-filter: blur(5px);
            border-radius: 60px;
            padding: 32px 28px 38px;
            box-shadow: 0 30px 40px rgba(0, 0, 0, 0.8), inset 0 0 0 1px rgba(255, 215, 140, 0.2);
            border: 1px solid #3d6175;
        }

        h1 {
            text-align: center;
            font-weight: 800;
            font-size: 2.8rem;
            letter-spacing: 2px;
            color: #ffde9e;
            text-shadow: 0 4px 0 #8f6f3a, 0 8px 15px black;
            margin-top: -10px;
            margin-bottom: 8px;
        }

        .sub {
            text-align: center;
            color: #b4d6ea;
            background: #1b3b4b;
            padding: 8px 32px;
            border-radius: 60px;
            width: fit-content;
            margin: 0 auto 25px;
            font-size: 1.2rem;
            border: 1px solid #578aa3;
        }

        /* ä¸»å¡ç‰‡ï¼šå›¾ç‰‡ + å•è¯ */
        .visual-card {
            background: #12303e;
            border-radius: 60px;
            padding: 30px 20px 20px;
            margin-bottom: 20px;
            border: 3px solid #6a9bb5;
            box-shadow: inset 0 -5px 0 #0b202b, 0 20px 30px #00000070;
        }

        .icon-area {
            font-size: 10rem;
            text-align: center;
            line-height: 1.2;
            color: #fbe4b6;
            text-shadow: 0 6px 0 #8b6d40, 0 10px 20px black;
            min-height: 160px;
        }

        .word-area {
            text-align: center;
            font-size: 5rem;
            font-weight: 700;
            color: #fff1d2;
            text-transform: uppercase;
            letter-spacing: 6px;
            text-shadow: 0 4px 0 #946f36;
            background: #1e4456;
            border-radius: 50px;
            padding: 10px 10px;
            margin: 10px 20px 0;
            border: 2px solid #ffcf8a;
        }

        /* ä¸‹ä¸€è¯é¢„è§ˆ */
        .next-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            background: #0b2a36;
            border-radius: 50px;
            padding: 8px 25px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        .next-preview i {
            font-size: 2.8rem;
            color: #ffcf8a;
        }
        .next-preview span {
            font-size: 2.5rem;
            font-weight: 500;
            color: #cddde6;
        }

        /* ç§¯åˆ†é¢æ¿ + èŠ‚å¥æ§åˆ¶ */
        .stats-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            background: #0c2c3a;
            border-radius: 60px;
            padding: 15px 25px;
            margin: 20px 0;
            border: 1px solid #57869e;
        }

        .score-box {
            background: #1e4557;
            border-radius: 50px;
            padding: 10px 30px;
            font-size: 2.4rem;
            font-weight: 700;
            color: #ffe39c;
            box-shadow: inset 0 2px 5px #08222b;
        }
        .score-box small {
            font-size: 1.2rem;
            color: #bed9ed;
        }

        .bpm-panel {
            display: flex;
            align-items: center;
            gap: 15px;
            background: #0c2c3a;
            padding: 8px 20px;
            border-radius: 40px;
        }
        .bpm-panel label {
            color: #d5c088;
            font-weight: 600;
        }
        #bpmSlider {
            width: 160px;
            height: 8px;
            border-radius: 20px;
            background: #30657c;
            -webkit-appearance: none;
        }
        #bpmSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            background: #fccd7c;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff0cc;
        }
        #bpmValue {
            font-size: 1.8rem;
            font-weight: 700;
            color: #fedb9f;
            min-width: 60px;
        }

        /* å½•éŸ³æŒ‰é’® + æ§åˆ¶ */
        .voice-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 25px 0 15px;
        }

        .record-btn {
            background: #dd6b4b;
            border: none;
            font-size: 2.2rem;
            font-weight: 700;
            padding: 20px 45px;
            border-radius: 60px;
            color: white;
            border-bottom: 7px solid #813e2b;
            transition: 0.08s;
            cursor: pointer;
            box-shadow: 0 10px 15px #00000060;
            display: inline-flex;
            align-items: center;
            gap: 20px;
            flex: 1 0 auto;
            justify-content: center;
        }
        .record-btn:active {
            transform: translateY(5px);
            border-bottom-width: 2px;
        }
        .record-btn.listening {
            background: #4faa6a;
            border-bottom-color: #1f6334;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .action-buttons button {
            background: #315f75;
            border: none;
            font-size: 1.8rem;
            padding: 15px 25px;
            border-radius: 50px;
            color: white;
            border-bottom: 5px solid #10333f;
            cursor: pointer;
            transition: 0.05s;
            font-weight: 600;
        }
        .action-buttons button:active {
            transform: translateY(4px);
            border-bottom-width: 1px;
        }

        /* è¯åº“é€‰æ‹© */
        .selector-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        .selector-bar select {
            background: #1d4357;
            color: white;
            font-size: 1.4rem;
            padding: 12px 30px;
            border-radius: 50px;
            border: 2px solid #70a5c2;
            font-weight: 500;
            min-width: 240px;
        }
        .selector-bar button {
            background: #d89e54;
            border: none;
            font-size: 1.4rem;
            padding: 12px 28px;
            border-radius: 50px;
            font-weight: 600;
            border-bottom: 4px solid #8a5f2b;
            cursor: pointer;
        }

        /* æœ€ç»ˆæŠ¥å‘Šæ¨¡æ€æ¡† */
        .report-modal {
            background: #03222e;
            border-radius: 50px;
            padding: 30px;
            margin-top: 20px;
            border: 3px solid #fcc46b;
            text-align: center;
        }
        .report-modal h2 {
            color: #ffde9e;
            font-size: 3rem;
        }
        .report-modal p {
            font-size: 2.5rem;
            color: white;
            background: #1d4a5e;
            padding: 15px;
            border-radius: 50px;
        }

        .hidden {
            display: none;
        }

        .status-msg {
            color: #c6e2ff;
            font-size: 1.4rem;
            background: #173d4e;
            padding: 6px 18px;
            border-radius: 30px;
        }

        footer {
            text-align: center;
            color: #45768b;
            margin-top: 25px;
        }
    </style>
</head>
<body>
<div class="game-card">
    <h1>ğŸ™ï¸ BEAT & SPEAK</h1>
    <div class="sub">ğŸ‘€ çœ‹å›¾è¯»éŸ³ Â· ç§¯åˆ†æŒ‘æˆ˜</div>

    <!-- å›¾ç‰‡ + å½“å‰å•è¯ -->
    <div class="visual-card">
        <div class="icon-area" id="wordIcon">ğŸ±</div>
        <div class="word-area" id="currentWord">cat</div>
    </div>

    <!-- ä¸‹ä¸€è¯é¢„è§ˆ -->
    <div class="next-preview">
        <i class="fas fa-arrow-right"></i>
        <span id="nextWord">fat</span>
        <i id="nextIcon" class="fas fa-bacon"></i>
    </div>

    <!-- ç§¯åˆ† & èŠ‚å¥ -->
    <div class="stats-row">
        <div class="score-box">
            <span id="scoreDisplay">0</span> <small> / <span id="totalWords">8</span></small>
        </div>
        <div class="bpm-panel">
            <label>âš¡BPM</label>
            <input type="range" id="bpmSlider" min="50" max="200" value="110" step="1">
            <span id="bpmValue">110</span>
        </div>
    </div>

    <!-- å½•éŸ³ + æ§åˆ¶åŒº -->
    <div class="voice-row">
        <button class="record-btn" id="recordBtn">
            <i class="fas fa-microphone"></i> ç‚¹å‡»æœ—è¯»
        </button>
        <div class="action-buttons">
            <button id="startBeatBtn">â–¶ å¼€å§‹èŠ‚æ‹</button>
            <button id="pauseBeatBtn">â¸ï¸ æš‚åœ</button>
            <button id="resetGameBtn">ğŸ”„ é‡ç½®</button>
        </div>
    </div>

    <!-- è¯åº“åˆ‡æ¢ -->
    <div class="selector-bar">
        <select id="topicSelect">
            <option value="animals" selected>ğŸ¾ åŠ¨ç‰© (cat, dog, pig...)</option>
            <option value="food">ğŸ é£Ÿç‰© (apple, cake, egg...)</option>
            <option value="actions">âš½ åŠ¨ä½œ (run, jump, dance...)</option>
            <option value="objects">ğŸ“š ç‰©å“ (book, pen, car...)</option>
        </select>
        <button id="applyTopicBtn">ğŸ“‹ åŠ è½½è¯åº“</button>
    </div>

    <!-- çŠ¶æ€ä¿¡æ¯ / æç¤º -->
    <div class="status-msg" id="statusMessage">ğŸ‘‹ å‡†å¤‡å¥½å°±å¼€å§‹å§</div>

    <!-- ç»“æŸæŠ¥å‘Š (åˆå§‹éšè—) -->
    <div id="reportCard" class="report-modal hidden">
        <h2>ğŸ‰ æŒ‘æˆ˜å®Œæˆ</h2>
        <p>âœ… æ­£ç¡®è¯»å¯¹ <span id="finalCorrect">0</span> / <span id="finalTotal">0</span> ä¸ªå•è¯</p>
        <button id="closeReportBtn" style="font-size:1.8rem; padding:10px 40px; margin-top:15px;">ç»§ç»­</button>
    </div>

    <footer>ğŸ¤ è¯»å‡ºæ˜¾ç¤ºçš„å•è¯ Â· è¯»å¯¹è‡ªåŠ¨åŠ åˆ†</footer>
</div>

<script>
    (function() {
        // ---------- å›¾æ–‡è¯åº“ (å•è¯ + Font Awesome å›¾æ ‡ / emoji å¤‡ç”¨) ----------
        const TOPIC_DATA = {
            animals: [
                { word: 'cat', icon: 'ğŸ±' },
                { word: 'dog', icon: 'ğŸ¶' },
                { word: 'pig', icon: 'ğŸ·' },
                { word: 'cow', icon: 'ğŸ®' },
                { word: 'bee', icon: 'ğŸ' },
                { word: 'fox', icon: 'ğŸ¦Š' },
                { word: 'frog', icon: 'ğŸ¸' },
                { word: 'duck', icon: 'ğŸ¦†' }
            ],
            food: [
                { word: 'apple', icon: 'ğŸ' },
                { word: 'cake', icon: 'ğŸ°' },
                { word: 'egg', icon: 'ğŸ¥š' },
                { word: 'pizza', icon: 'ğŸ•' },
                { word: 'banana', icon: 'ğŸŒ' },
                { word: 'carrot', icon: 'ğŸ¥•' },
                { word: 'milk', icon: 'ğŸ¥›' },
                { word: 'cookie', icon: 'ğŸª' }
            ],
            actions: [
                { word: 'run', icon: 'ğŸƒ' },
                { word: 'jump', icon: 'ğŸ¦˜' },
                { word: 'dance', icon: 'ğŸ’ƒ' },
                { word: 'sing', icon: 'ğŸ¤' },
                { word: 'swim', icon: 'ğŸŠ' },
                { word: 'sleep', icon: 'ğŸ˜´' },
                { word: 'eat', icon: 'ğŸ½ï¸' },
                { word: 'read', icon: 'ğŸ“–' }
            ],
            objects: [
                { word: 'book', icon: 'ğŸ“˜' },
                { word: 'pen', icon: 'âœ’ï¸' },
                { word: 'car', icon: 'ğŸš—' },
                { word: 'ball', icon: 'âš½' },
                { word: 'chair', icon: 'ğŸª‘' },
                { word: 'phone', icon: 'ğŸ“±' },
                { word: 'clock', icon: 'ğŸ•°ï¸' },
                { word: 'key', icon: 'ğŸ”‘' }
            ]
        };

        // ---------- å…¨å±€å˜é‡ ----------
        let currentTopic = 'animals';
        let wordsList = TOPIC_DATA.animals.map(item => item.word);           // å•è¯æ•°ç»„
        let iconsList = TOPIC_DATA.animals.map(item => item.icon);           // å¯¹åº”å›¾æ ‡
        let currentIndex = 0;
        let correctCount = 0;          // è¯»å¯¹æ¬¡æ•°
        let attemptedCount = 0;         // å·²ç»å°è¯•è¿‡çš„å•è¯ä¸ªæ•° (å³å·²å±•ç¤ºè¿‡å¤šå°‘ä¸ªï¼Œç”¨äºæ€»åˆ†)
        let totalWords = wordsList.length;

        // èŠ‚æ‹ç›¸å…³
        let bpm = 110;
        let beatInterval = null;
        let isBeatPlaying = false;

        // è¯­éŸ³è¯†åˆ«
        let recognition = null;
        let isListening = false;
        let canScore = true;            // é˜²æ­¢åŒä¸€å•è¯å¤šæ¬¡åŠ åˆ† (å•æ¬¡æœ—è¯»åªåŠ ä¸€æ¬¡)

        // DOM å…ƒç´ 
        const wordIcon = document.getElementById('wordIcon');
        const currentWordSpan = document.getElementById('currentWord');
        const nextWordSpan = document.getElementById('nextWord');
        const nextIcon = document.getElementById('nextIcon');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const totalWordsSpan = document.getElementById('totalWords');
        const bpmSlider = document.getElementById('bpmSlider');
        const bpmValue = document.getElementById('bpmValue');
        const recordBtn = document.getElementById('recordBtn');
        const startBeatBtn = document.getElementById('startBeatBtn');
        const pauseBeatBtn = document.getElementById('pauseBeatBtn');
        const resetGameBtn = document.getElementById('resetGameBtn');
        const topicSelect = document.getElementById('topicSelect');
        const applyTopicBtn = document.getElementById('applyTopicBtn');
        const statusMsg = document.getElementById('statusMessage');
        const reportCard = document.getElementById('reportCard');
        const finalCorrectSpan = document.getElementById('finalCorrect');
        const finalTotalSpan = document.getElementById('finalTotal');
        const closeReportBtn = document.getElementById('closeReportBtn');

        // ---------- è¾…åŠ©å‡½æ•° ----------
        function updateDisplay() {
            if (wordsList.length === 0) return;
            // å½“å‰
            currentWordSpan.textContent = wordsList[currentIndex];
            wordIcon.innerHTML = iconsList[currentIndex];

            // ä¸‹ä¸€ä¸ª (å¾ªç¯)
            let nextIdx = (currentIndex + 1) % wordsList.length;
            nextWordSpan.textContent = wordsList[nextIdx];
            nextIcon.innerHTML = iconsList[nextIdx];

            // æ€»åˆ†æ˜¾ç¤º
            totalWordsSpan.textContent = wordsList.length;
        }

        function updateScoreUI() {
            scoreDisplay.textContent = correctCount;
        }

        // é‡ç½®æœ¬è½® (ä¸æ¸…é™¤æ€»åˆ†ï¼Œåªé‡ç½®ç´¢å¼•/å°è¯•æ¬¡æ•°/åˆ†æ•°å¯é€‰é¡¹)
        function resetRound() {
            currentIndex = 0;
            correctCount = 0;
            attemptedCount = 0;
            canScore = true;
            updateDisplay();
            updateScoreUI();
            hideReport();
        }

        // åŠ è½½æ–°è¯åº“
        function loadTopic(topicKey) {
            const data = TOPIC_DATA[topicKey] || TOPIC_DATA.animals;
            wordsList = data.map(item => item.word);
            iconsList = data.map(item => item.icon);
            totalWords = wordsList.length;
            resetRound();      // ç´¢å¼•å½’é›¶ï¼Œåˆ†æ•°å½’é›¶
            updateDisplay();
            hideReport();
        }

        // æ˜¾ç¤ºæŠ¥å‘Š
        function showReport() {
            finalCorrectSpan.textContent = correctCount;
            finalTotalSpan.textContent = wordsList.length;
            reportCard.classList.remove('hidden');
        }
        function hideReport() {
            reportCard.classList.add('hidden');
        }

        // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯ (ç”±èŠ‚æ‹æˆ–æ‰‹åŠ¨è§¦å‘)
        function nextWord() {
            if (wordsList.length === 0) return;
            // å¦‚æœå·²ç»å±•ç¤ºè¿‡ï¼Œç®—attemptedCount (ä½†ä¸é‡å¤è®¡æ•°)
            attemptedCount = Math.min(attemptedCount + 1, wordsList.length);
            // å¾ªç¯ç´¢å¼•
            currentIndex = (currentIndex + 1) % wordsList.length;
            // é‡ç½®å¯åŠ åˆ†æ ‡è®° (æ–°å•è¯å¯è¢«è¯»)
            canScore = true;
            updateDisplay();

            // å¦‚æœ attemptedCount >= totalWords ä¸” æ²¡æœ‰éšè—æŠ¥å‘Š ä¸” æ²¡æœ‰å…¨å¯¹ä¹Ÿå¯æ˜¾ç¤ºç»“æŸ(å…¨è¯»å®Œ)
            if (attemptedCount >= totalWords && correctCount <= totalWords) {
                // ä¸€è½®ç»“æŸï¼Œæ˜¾ç¤ºæŠ¥å‘Š (ä½†ä¸è¦é‡å¤å¼¹)
                if (reportCard.classList.contains('hidden')) {
                    showReport();
                }
                // åŒæ—¶å¯ä»¥æš‚åœèŠ‚æ‹
                if (isBeatPlaying) pauseBeat();
            }
        }

        // ---------- èŠ‚æ‹æ§åˆ¶ ----------
        function startBeat() {
            if (beatInterval) clearInterval(beatInterval);
            const intervalMs = 60000 / bpm;
            beatInterval = setInterval(() => {
                nextWord();       // æ¯ä¸ªèŠ‚æ‹è‡ªåŠ¨åˆ‡å•è¯
            }, intervalMs);
            isBeatPlaying = true;
        }

        function pauseBeat() {
            if (beatInterval) {
                clearInterval(beatInterval);
                beatInterval = null;
            }
            isBeatPlaying = false;
        }

        function setBPM(value) {
            bpm = value;
            bpmValue.textContent = bpm;
            if (isBeatPlaying) {
                pauseBeat();
                startBeat();
            }
        }

        // ---------- è¯­éŸ³è¯†åˆ«åˆå§‹åŒ– ----------
        function initSpeech() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                statusMsg.innerHTML = 'âš ï¸ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«ï¼Œè¯·ä½¿ç”¨ Chrome/Edge æœ€æ–°ç‰ˆã€‚';
                return false;
            }
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;       // å•æ¬¡è¯†åˆ«
            recognition.interimResults = false;    // åªè¿”å›æœ€ç»ˆç»“æœ
            recognition.lang = 'en-US';            // è‹±æ–‡è¯†åˆ«

            recognition.onstart = () => {
                isListening = true;
                recordBtn.classList.add('listening');
                recordBtn.innerHTML = '<i class="fas fa-microphone-slash"></i> è†å¬ä¸­...';
                statusMsg.innerHTML = 'ğŸ¤ è¯·å¤§å£°æœ—è¯»å•è¯';
            };

            recognition.onerror = (event) => {
                console.warn('è¯†åˆ«é”™è¯¯', event.error);
                isListening = false;
                recordBtn.classList.remove('listening');
                recordBtn.innerHTML = '<i class="fas fa-microphone"></i> ç‚¹å‡»æœ—è¯»';
                statusMsg.innerHTML = 'âŒ è¯†åˆ«å¤±è´¥ï¼Œå†è¯•ä¸€æ¬¡';
                canScore = true;   // è¿™æ¬¡ä¸ç®—ï¼Œé‡æ–°å…è®¸åŠ åˆ†
            };

            recognition.onend = () => {
                isListening = false;
                recordBtn.classList.remove('listening');
                recordBtn.innerHTML = '<i class="fas fa-microphone"></i> ç‚¹å‡»æœ—è¯»';
            };

            recognition.onresult = (event) => {
                const last = event.results.length - 1;
                if (last < 0) return;
                const transcript = event.results[last][0].transcript.trim().toLowerCase();
                statusMsg.innerHTML = `ğŸ“ è¯†åˆ«: "${transcript}"`;

                // æ¯”å¯¹å½“å‰å•è¯ (å¹¶ä¸”å…è®¸åŠ åˆ†)
                const targetWord = wordsList[currentIndex].toLowerCase();
                // ç®€å•åˆ¤æ–­ï¼šåŒ…å«ç›®æ ‡è¯æˆ–å®Œå…¨åŒ¹é…(å»é™¤æ ‡ç‚¹)
                const cleanTranscript = transcript.replace(/[.,!?;:]$/, ''); // ç§»é™¤æœ«å°¾æ ‡ç‚¹
                if (canScore && (cleanTranscript === targetWord || transcript === targetWord)) {
                    correctCount += 1;
                    updateScoreUI();
                    canScore = false;    // åŒä¸€å•è¯åªèƒ½åŠ åˆ†ä¸€æ¬¡
                    statusMsg.innerHTML = 'âœ… æ­£ç¡® +1 åˆ†ï¼';
                } else {
                    if (canScore) statusMsg.innerHTML = 'âŒ æ²¡è¯»å¯¹ï¼Œå†è¯•è¯•';
                }
            };

            return true;
        }

        // å¼€å§‹å½•éŸ³
        function startListening() {
            if (!recognition) {
                if (!initSpeech()) return;
            }
            if (isListening) {
                recognition.stop();
                return;
            }
            try {
                recognition.start();
            } catch (e) {
                console.warn('å¤šæ¬¡å¿«é€Ÿå¯åŠ¨å¯èƒ½ä¼šæŠ¥é”™', e);
                // é‡æ–°åˆ›å»ºå®ä¾‹
                initSpeech();
                setTimeout(() => recognition.start(), 100);
            }
        }

        // ---------- äº‹ä»¶ç»‘å®š ----------
        bpmSlider.addEventListener('input', (e) => {
            const val = parseInt(e.target.value);
            setBPM(val);
        });

        startBeatBtn.addEventListener('click', () => {
            if (!isBeatPlaying) startBeat();
        });
        pauseBeatBtn.addEventListener('click', pauseBeat);
        resetGameBtn.addEventListener('click', () => {
            pauseBeat();
            resetRound();
            hideReport();
        });

        applyTopicBtn.addEventListener('click', () => {
            pauseBeat();
            currentTopic = topicSelect.value;
            loadTopic(currentTopic);
        });

        recordBtn.addEventListener('click', startListening);

        // å…³é—­æŠ¥å‘Šï¼Œå¯ä»¥ç»§ç»­ä¸‹ä¸€è½®ï¼ˆé‡ç½®å°è¯•è®¡æ•°ï¼Œä½†ä¿ç•™åˆ†æ•°ï¼Ÿè®¾è®¡ä¸Šé‡ç½®æœ¬è½®ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¿ç•™ã€‚æŒ‰éœ€ï¼šé‡ç½®è®¡æ•°ï¼Œä½†åˆ†æ•°å¯ç´¯åŠ ï¼Ÿè¿™é‡Œè®¾å®šå…³é—­æŠ¥å‘Šåä¸æ¸…é™¤å¾—åˆ†ï¼Œç»§ç»­ä¸‹ä¸€è½®ï¼Œç´¯åŠ æ­£ç¡®æ•°ï¼‰
        closeReportBtn.addEventListener('click', () => {
            hideReport();
            // é‡ç½® attemptedCount ä½†ä¸å½’é›¶å¾—åˆ† (è®©æ€»åˆ†å¯ç»§ç»­å¢åŠ )
            attemptedCount = 0;
            currentIndex = 0;        // å›åˆ°è¯åº“å¼€å¤´
            canScore = true;
            updateDisplay();
        });

        // åˆå§‹åŒ–è¯åº“
        loadTopic('animals');
        setBPM(110);
        initSpeech();
    })();
</script>
</body>
</html>
